function CheckBoxClickHandler(e,i){var t=e.id,n=t.replace(/ckbx_/g,""),d=$("input[id='"+t+"']").parent().attr("id"),l=d.replace(/li_/g,""),r=$("li[id='"+d+"']").parent().attr("id");if("Decision"==$("input[id='nodetype_"+r.replace(/li_ul_/g,"")+"']").attr("value")&&(e.checked&&$("input[id='Compact']").is(":checked")?$("li[id='"+d+"']").siblings().hide():($("li[id='"+d+"']").siblings().show(),$("li[id='"+d+"']").siblings().each((function(){RefreshFillers(this.id.replace(/li_/g,""),!1)})))),asynchronous=!1,e.checked&&0==$("ul[id='li_ul_"+n+"']").children().length?$.jstree._reference("li[id='li_"+n+"']").open_node("li[id='li_"+n+"']"):(!e.checked&&$("input[id='Compact']").is(":checked")&&$("#container").jstree("close_node",$("li[id='li_"+n+"']")),e.checked&&$("#container").jstree("open_node",$("li[id='li_"+n+"']"))),asynchronous=!0,e.checked){for(var a=$("li[id='"+d+"']").parent("ul").parent("li");"li_1"!=a.attr("id")&&(!$("input[id='ckbx_"+a.attr("id").replace(/li_/g,"")+"']").length||$("input[id='ckbx_"+a.attr("id").replace(/li_/g,"")+"']").is(":checked"));)a=a.parent("ul").parent("li");"li_1"!=a.attr("id")&&($("input[id='ckbx_"+a.attr("id").replace(/li_/g,"")+"']").attr("checked",!0),CheckBoxClickHandler(document.getElementById("ckbx_"+a.attr("id").replace(/li_/g,"")),!1))}var o=e.checked?"true":"false";if($.ajax({url:"SetCheckboxState?id="+n+"&state="+o,type:"GET",dataType:"json",async:!1,cache:!1,beforeSend:function(){},complete:function(){},success:function(e){$("#price").text("Total: "+e.total);for(var i=";"+$("input[id='dependents_"+l+"']").attr("value"),t=GetBranch(l).split(";"),n=0;n<t.length;n++)-1==i.indexOf(";"+t[n]+";")&&(i=i+";"+t[n]);var r=$("li[id='"+d+"']").find("li");for(n=0;n<r.length;n++)i+=";"+r[n].id.replace(/li_/g,"");UpdateNodesFromServer(i)}}),e.checked&&"Decision"==$("input[id='nodetype_"+r.replace(/li_ul_/g,"")+"']").attr("value")){var c=$("li[id='"+d+"']").siblings().children("input:checked");if(0!=c.length){for(var s=";"+c[0].id.replace(/ckbx_/g,""),h=$("li[id='li_"+c[0].id.replace(/ckbx_/g,"")+"']").find("li").filter((function(){return"false"==$("input[id='isoptional_"+$(this).attr("id").replace(/li_/g,"")+"']").attr("value")})),p=0;p<h.length;p++)s+=";"+h[p].id.replace(/li_/g,"");var f=";"+$("input[id='dependents_"+c[0].id.replace(/ckbx_/g,"")+"']").attr("value"),u=f.split(";");for(p=0;p<u.length;p++)-1==s.indexOf(";"+u[p]+";")&&(s=s+";"+u[p]);s+=f,asynchronous=!0,UpdateNodesFromServer(s)}}e.checked&&!descriptionhidden&&$("li[id='li_"+n+"']").children("a").click(),e.checked||"Decision"!=$("input[id='nodetype_"+r.replace(/li_ul_/g,"")+"']").attr("value")||descriptionhidden||$("li[id='li_"+r.replace(/li_ul_/g,"")+"']").children("a").click(),i&&$("input[id='"+t+"']").is(":checked")&&(asynchronous,ExpandLevels2(n,$("input[id='expandedlevels_"+n+"']").attr("value")))}function UpdateParent(e){$.ajax({url:"NodeInfo?id="+e,type:"GET",dataType:"json",cache:!1,beforeSend:function(){},complete:function(){},success:function(e){var i=$("li[id='li_"+e.id+"']").parent().attr("id");e.complete||e.optional&&!e.selected?$("li[id='li_"+e.id+"']").children("img").hide():$("li[id='li_"+e.id+"']").children("img").show(),UpdateNode(e),"container"!=$("li[id='li_"+e.id+"']").parent().parent().attr("id")&&UpdateParent(i.replace(/li_ul_/g,""))}})}function GetBranch(e){var i="";return function e(t){i+=t+";";var n="li[id='li_"+t+"']";"container"!=$(n).parent().parent().attr("id")&&e($(n).parent().attr("id").replace(/li_ul_/g,""))}(e),i}function getScrollbarWidth(e){return e.offsetWidth-e.clientWidth}function UpdateNode(e){var i="li[id='li_"+e.id+"']";if($(i).length){var t,n;if($(i).css("gray-space","normal"),$(i).width($("#container").width()-($(i).offset().left-$("#container").offset().left)),$("input[id='ckbx_"+e.id+"']").remove(),e.optional&&(t=1==e.selected?"checked":"",n="<input type='checkbox' ",e.disabled&&($(i).siblings().show(),n+="disabled='true'"),n+=" id='ckbx_"+e.id+"' style='padding:0px 0px 0px 0px; margin:0px 0px 0px 2px;' onchange='CheckBoxClickHandler(this, true);' "+t+"/>",$(i).children("ins").after(n)),n="<img src='../Images/blinkcircle.gif' class='incomplete' style='display: none;' height='14' width='14'>",$(i).children(".incomplete").remove(),$(i).children("ins").after(n),e.complete||e.optional&&!e.selected?$(i).children(".incomplete").hide():$(i).children(".incomplete").show(),0==$(i).children("a").length){$(i).append("<a></a>");var d="../"+e.url;$(i).children("a").attr("href",d),$(i).children("a").attr("target","details")}$(i).children("a").empty(),$(i).children("a").append("<span class='name' id='name_"+e.id+"'>"+e.name+"</span>"),$(i).children("a").append("<span class='formula' id='formula_"+e.id+"' > "+("Decision"!=e.type&&"SumSet"!=e.type&&"Date"!=e.type&&"Today"!=e.type?" &nbsp;[<i>"+e.expression+"</i>]":"")+"</span>"),$("input[id='Formulas']").is(":checked")||$(i).children("a").children(".formula").hide(),$(i).children(".subtotal").remove(),$(i).children(".filler").remove();var l,r,a,o,c,s,h,p,f=$("<div class='filler'>&nbsp;</div>"),u=$("<span class='subtotal' id='subtotal_"+e.id+"'><font size='1'></font>  <font>["+e.subtotal+"]</font></span>");$(i).children("a").after(u),$(i).children("a").after(f),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&$(i).children("a").attr("style","color:gray;"),window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches&&$(i).children("a").attr("style","color:black;"),e.leaf&&$("li[id='li_"+e.id+"']").children("a").attr("style","color:red;"),e.hidden&&$("li[id='li_"+e.id+"']").children("a").attr("style","color:green"),h=e.checkbox?13:0,s=e.complete?0:16;var g=$(i).children("a").children(".formula"),_=$(i).children("a").children(".name");if($(i).width($("#container").width()-($(i).offset().left-$("#container").offset().left)),l=$(i).width(),r=$(i).children("a").width(),idWidth=0,0,a=$(i).children(".subtotal").width(),o=$(i).children("ins").width(),"none"==g.css("display")?(g.show(),c=g.width(),g.hide()):c=g.width(),p=_.width(),0==g.children("i").length&&(c=0),r+a+o+idWidth+0+h+s+25>l){var m=r+a+o+idWidth+0+h+s+25-l;c>=m?g.width(c-m):(g.width(0),_.width(p-(m-c)))}else g.width(c+5),_.width(p+5);var v=getScrollbarWidth(document.getElementById("container"));if($(i).children(".filler").css("width",l-r-a-o-idWidth-0-h-s-30-v),l-r-a-o-idWidth-0-h-s-30-v>0&&$(i).children(".filler").css("margin-right",a+v),"FONT"!=$("li[id='li_"+e.id+"']").children()[0].tagName){var w=$("li[id='li_1']").position().left;$("<font width='100%' size='1' class='id'>&nbsp"+e.id+"</font>").insertBefore("li[id='li_"+e.id+"']>ins"),$(".id").css({position:"absolute",left:w});var y=$("font[id='id_"+e.Id+"']").width(),b=$(i).children("ins").position().left;y>b?$(i).css("margin-left",y-b+13.5):$(i).css("margin-left",13.5)}}}function UpdateNodeFromServer(e){$.ajax({url:"NodeInfo?id="+e,type:"GET",dataType:"json",cache:!1,beforeSend:function(){},complete:function(){},success:function(e){e.complete||e.optional&&!e.selected?$("li[id='li_"+e.id+"']").children("img").hide():$("li[id='li_"+e.id+"']").children("img").show(),UpdateNode(e)}})}function UpdateNodesFromServer(e){var i;i=e.split(";"),$.ajax({url:"NodesInfo",type:"POST",dataType:"json",data:{array:i},traditional:!0,async:"true"==asynchronous,cache:!1,beforeSend:function(){},complete:function(){},success:function(e){for(var i=0;i<e.length;i++)e[i].complete||e[i].optional&&!e[i].selected?"li[id='li_"+e[i].id+"'],":"li[id='li_"+e[i].id+"'],",UpdateNode(e[i])}})}function UpdateDependents(e){if("object"==typeof e){for(var i,t="",n=0;n<e.length;n++)t+=";"+e[n]+";"+$("input[id='dependents_"+e[n]+"']").attr("value");i=(i=t.split(";")).filter((function(e,t){return i.indexOf(e)===t})),t="";for(n=0;n<i.length;n++)t+=i[n]+";";UpdateNodesFromServer(t)}else{UpdateNodesFromServer(e+";"+(t=$("input[id='dependents_"+e+"']").attr("value")))}}function UpdateTree(e){$.ajax({url:"NodeInfo?id="+e,type:"GET",dataType:"json",cache:!1,beforeSend:function(){},complete:function(){},success:function(e){e.complete||e.optional&&!e.selected?$("li[id='li_"+e.id+"']").children("img").hide():$("li[id='li_"+e.id+"']").children("img").show(),UpdateNode(e);var i="li[id='li_"+e.id+"']",t=$(i).children("ul").children("li");if(t&&t.length>0)for(var n=0;n<t.length;n++)UpdateTree(t[n].id.replace(/li_/g,""))}})}function UpdateTreeSync(){var e="";!function i(t){e+=t+";";var n=$("li[id='li_"+t+"']").children("ul").children("li");if(n&&n.length>0)for(var d=0;d<n.length;d++)i(n[d].id.replace(/li_/g,""))}(1),UpdateNodesFromServer(e)}function HideNodes(e){"true"==$("input[id='ishidden_"+e+"']").attr("value")&&$("li[id='li_"+e+"']").hide();var i=$("li[id='li_"+e+"']").children("ul").children("li");if(i&&i.length>0)for(var t=0;t<i.length;t++)HideNodes(i[t].id.replace(/li_/g,""))}function ShowNodes(e){"true"==$("input[id='ishidden_"+e+"']").attr("value")&&($("li[id='li_"+e+"']").css("display","block"),RefreshFillers(e,!1));var i=$("li[id='li_"+e+"']").children("ul").children("li");if(i&&i.length>0)for(var t=0;t<i.length;t++)ShowNodes(i[t].id.replace(/li_/g,""))}function UnHideBranch(e){$("li[id='li_"+e+"']").show();var i=$("li[id='li_"+e+"']").parent().attr("id");"container"!=$("li[id='li_"+e+"']").parent().parent().attr("id")&&UnHideBranch(i.replace(/li_ul_/g,""))}function ToggleSubtotals(){$("input[id='Subtotals']").is(":checked")?($(".subtotal").show(),$(".filler").show(),RefreshFillers(1,!0)):($(".subtotal").hide(),$(".filler").hide())}function ToggleFormulas(){expandingLevels=!1,$("input[id='Formulas']").is(":checked")?($(".formula").show(),RefreshFillers("1",!0)):($(".formula").hide(),RefreshFillers("1",!0))}function ToggleFormulasAsync(){expandingLevels=!1,$("input[id='Formulas']").is(":checked")?($(".filler").width(0),$(".formula").width(0),$(".formula").show(),UpdateTree("1")):($(".formula").hide(),UpdateTree("1"))}function ToggleHiddenFields(){expandingLevels=!1,$("input[id='HiddenFields']").is(":checked")?ShowNodes("1"):HideNodes("1")}function ToggleDescription(){if(expandingLevels=!1,descriptionhidden=!descriptionhidden,$("#description").toggle(),"right"==$("#container").css("float")?($("#container").css("float","left"),$("#container").css("width","100%")):($("#container").css("float","right"),$("#container").css("width","60%")),"left"==$("#container").css("float")?$("#hr").css("width","100%"):$("#hr").css("width","59.5%"),RefreshFillers(1,!0),!descriptionhidden){var e=document.getElementById("Iframe15"),i=e.contentDocument||e.contentWindow.document;i.location=i.location}}function ToggleDescriptionAsync(){if(expandingLevels=!1,descriptionhidden=!descriptionhidden,$("#description").toggle(),"right"==$("#container").css("float")?($("#container").css("float","left"),$("#container").css("width","100%")):($("#container").css("float","right"),$("#container").css("width","60%")),"left"==$("#container").css("float")?$("#hr").css("width","100%"):$("#hr").css("width","59.5%"),$(".filler").width(0),$(".formula").width(0),UpdateTree("1"),!descriptionhidden){var e=document.getElementById("Iframe15"),i=e.contentDocument||e.contentWindow.document;i.location=i.location}}function ToggleCompact(){if(expandingLevels=!1,$("input[id='Compact']").is(":checked")){(e=$("#container li").filter((function(){var e=$(this).parent().attr("id");return null!=e&&"Decision"==$("input[id='nodetype_"+e.replace(/li_ul_/g,"")+"']").attr("value")&&!$(this).children(":checkbox").is(":checked")&&1==$(this).siblings().children("input:checked").length}))).hide()}else{var e;(e=$("#container li").filter((function(){return"none"==$(this).css("display")&&"false"==$("input[id='ishidden_"+$(this).attr("id").replace(/li_/g,"")+"']").attr("value")}))).show();for(var i=0;i<e.length;i++)RefreshFillers(e[i].id.replace(/li_/g,""),!1)}}function ToggleId(){$("input[id='Id']").is(":checked")?ShowIds():HideIds()}function ShowIds(){$(".id").show()}function HideIds(){$(".id").hide()}function EnlargeFillers(e){var i="li[id='li_"+e+"']";$(i).children(".filler").css("width",$(i).children(".filler").width()+$(i).children("a").children(".formula").width());var t=$(i).children("ul").children("li");if(t&&t.length>0)for(var n=0;n<t.length;n++)EnlargeFillers(t[n].id.replace(/li_/g,""))}function ShortenFillers(e){var i="li[id='li_"+e+"']";$(i).children(".filler").css("width",$(i).children(".filler").width()-$(i).children("a").children(".formula").width());var t=$(i).children("ul").children("li");if(t&&t.length>0)for(var n=0;n<t.length;n++)ShortenFillers(t[n].id.replace(/li_/g,""))}function Refill(){RefreshFillers(1,!0)}function RefreshFillers(e,i){var t="li[id='li_"+e+"']";if($(t).length){$(t).width($("#container").width()-($(t).offset().left-$("#container").offset().left));var n=$(t).children("a").children(".name").text(),d=$(t).children("a").children(".formula").children("i").text(),l=($(t).children(".subtotal").children("font").eq(0).text(),$(t).children(".subtotal").children("font").eq(1).text());$(t).children("a").empty(),$(t).children("a").append("<span class='name' id='name_"+e+"'>"+n+"</span>"),$(t).children("a").append("<span class='formula' id='formula_"+e+"' >"+("Decision"!=$("input[id='nodetype_"+e+"']").attr("value")&&"Date"!=$("input[id='nodetype_"+e+"']").attr("value")&&"Today"!=$("input[id='nodetype_"+e+"']").attr("value")?" &nbsp;[<i>"+d.trim()+"</i>]":"")+"</span>"),$("input[id='Formulas']").is(":checked")||$(t).children("a").children(".formula").hide(),$(t).children(".subtotal").remove(),$(t).children(".filler").remove();var r,a,o,c,s,h,p,f,u=$("<div class='filler'>&nbsp;</div>"),g=$("<span class='subtotal' id='subtotal_"+e+"'><font size='1'></font> <font>"+l+"</font></span>");$(t).children("a").after(g),$(t).children("a").after(u),p=$("input[id='ckbx_"+e+"']").length?13:0,h=$(t).children("img").is(":visible")?16:0;var _=$(t).children("a").children(".formula"),m=($(t).children("a"),$(t).children("a").children(".name"));if(r=$(t).width(),a=$(t).children("a").width(),o=$(t).children(".subtotal").width(),c=$(t).children("ins").width(),"none"==_.css("display")?(_.show(),s=_.width(),_.hide()):s=_.width(),f=m.width(),a+o+c+p+h+25>r){var v=a+o+c+p+h+25-r;"none"!=_.css("display")&&s>=v+25?_.width(s-v-25):(_.width(0),"none"!=_.css("display")?m.width(f-(v-s)):m.width(f-v))}else"none"!=_.css("display")&&_.width(s+5),m.width(f+5);var w=getScrollbarWidth(document.getElementById("container"));if($(t).children(".filler").css("width",r-a-o-c-p-h-25-w),r-a-o-c-p-h-25-w>0&&$(t).children(".filler").css("margin-right",o+w),!0){var y=$(t).children("ul").children("li");if(y&&y.length>0)for(var b=0;b<y.length;b++)RefreshFillers(y[b].id.replace(/li_/g,""),!0)}}$("input[id='Subtotals']").is(":checked")||$(".subtotal, .filler").hide()}function OpenNode(e){for(var i=e.split(">"),t="li[id='li_1']",n=0;n<i.length;n++)top.asynchronous=!1,$.jstree._reference(t).open_node(t,(function(){if(n==i.length-1)$.jstree._reference("li[id='li_@Model.id']").deselect_node("li[id='li_@Model.id']"),$.jstree._reference(t).select_node(t),$("html").scrollTop($(t).offset().top);else for(var e=$(t).children("ul").children("li"),d=0;d<e.length;d++)if($(e[d]).children("a").children("font:first").text()==i[n+1]){t="li[id='"+$(e[d]).attr("id")+"']";break}}));top.asynchronous=!0}function ExpandLevels(e,i){0!=i&&(asynchronous=!1,$.jstree._reference("li[id='li_"+e+"']").open_node("li[id='li_"+e+"']",(function(){var t=$("li[id='li_"+e+"']").children("ul").children("li");if(t&&t.length>0)for(var n=0;n<t.length;n++)ExpandLevels(t[n].id.replace(/li_/g,""),i-1)})),asynchronous=!0)}function ExpandLevels2(e,i){if(expandingLevels=!0,0!=i){var t=$("li[id='li_"+e+"']").children("ul");if(0==t.length||0==t.children("li").length)$.ajax({url:"ChildNodes?id="+e,type:"GET",dataType:"json",cache:!1,beforeSend:function(){},complete:function(e){for(var t=jQuery.parseJSON(e.responseText),n=0;n<t.length;n++)ExpandLevels2(t[n].id,i-1)},success:function(i){Assemble(i,"li_"+e),$("#container").jstree("open_node",$("li[id='li_"+e+"']"))}});else{$("#container").jstree("open_node",$("li[id='li_"+e+"']")),RefreshFillers(e,!0);for(var n=$("li[id='li_"+e+"']").children("ul").children("li"),d=0;d<n.length;d++)ExpandLevels2(n[d].id.replace(/li_/g,""),i-1)}}}function Assemble(e,i){var t=i;$(i).children("ul");$("#container").jstree("select_node",$("li[id='"+t+"']"));for(var n=0;n<e.length;n++){$("#container").jstree("create",null,"last",{data:" ",attr:{class:"jstree-closed",id:"li_"+e[n].id}},!1,!0),UpdateNode(e[n]),1!=e[n].hidden||$("input[id='HiddenFields']").is(":checked")||$("li[id='li_"+e[n].id+"']").hide();var d,l=e[n].url;$("li[id='li_"+e[n].id+"']").children("a").attr("href",l),$("li[id='li_"+e[n].id+"']").children("a").attr("target","details"),window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&$("li[id='li_"+e[n].id+"']").children("a").attr("style","color:gray;"),e[n].leaf&&$("li[id='li_"+e[n].id+"']").children("a").attr("style","color:red;"),e[n].hidden&&$("li[id='li_"+e[n].id+"']").children("a").attr("style","color:green"),d="<input type='hidden' id='nodetype_"+e[n].id+"' value='"+e[n].type+"'/> ",$("li[id='li_"+e[n].id+"']").append(d),d="<input type='hidden' id='ishidden_"+e[n].id+"' value='"+e[n].hidden+"'/> ",$("li[id='li_"+e[n].id+"']").append(d),d="<input type='hidden' id='isoptional_"+e[n].id+"' value='"+e[n].optional+"'/> ",$("li[id='li_"+e[n].id+"']").append(d),d="<input type='hidden' id='dependents_"+e[n].id+"' value='"+e[n].dependents+"'/> ",$("li[id='li_"+e[n].id+"']").append(d),d="<input type='hidden' id='editchildren_"+e[n].id+"' value='"+e[n].editChildren+"'/> ",$("li[id='li_"+e[n].id+"']").append(d),d="<input type='hidden' id='expandedlevels_"+e[n].id+"' value='"+e[n].expandedLevels+"'/> ",$("li[id='li_"+e[n].id+"']").append(d)}$("li[id='"+t+"']").children("ul").attr("id","li_ul_"+t.replace(/li_/g,"")),$("#container").jstree("deselect_node",$("li[id='"+t+"']"))}function RenderTree(e){var i=e.Id.substr(0,e.Id.lastIndexOf("."));1!=e.Id&&$("#container").jstree("select_node",$("li[id='li_"+i+"']")),$("#container").jstree("create",null,"last",{data:" ",attr:{class:"jstree-closed",id:"li_"+e.Id}},!1,!0);var t="li[id='li_"+e.Id+"']";if($(t).length){var n,d;$(t).css("gray-space","normal"),$(t).width($("#container").width()-($(t).offset().left-$("#container").offset().left)),$("input[id='ckbx_"+e.Id+"']").remove(),e.Optional&&(n=1==e.Selected?"checked":"",d="<input type='checkbox' ",e.Disabled&&($(t).siblings().show(),d+="disabled='true'"),d+=" id='ckbx_"+e.Id+"' style='padding:0px 0px 0px 0px; margin:0px 0px 0px 2px;' onchange='CheckBoxClickHandler(this, true);' "+n+"/>",$(t).children("ins").after(d)),d="<img src='../Images/blinkcircle.gif' class='incomplete' style='display: none;' height='14' width='14'>",$(t).children(".incomplete").remove(),$(t).children("ins").after(d),e.Complete||e.Optional&&!e.Selected?$(t).children(".incomplete").hide():$(t).children(".incomplete").show();var l="../"+e.Url;$(t).children("a").attr("href",l),$(t).children("a").attr("target","details"),$(t).children("a").empty(),$(t).children("a").append("<span class='name' id='name_"+e.Id+"'>"+e.Name+"</span>");var r="";r=null!=e.Expression||"ConditionalRules"==e.TypeStr?"&nbsp;[<i>"+e.Expression.trim()+"</i>]":"",$(t).children("a").append("<span class='formula' id='formula_"+e.Id+"' > "+r+"</span>"),$("input[id='Formulas']").is(":checked")||$(t).children("a").children(".formula").hide(),!$("input[id='HiddenFields']").is(":checked")&&e.Hidden&&$(t).hide();var a,o,c,s,h,p,f,u,g=$("<div class='filler'>&nbsp;</div>"),_=$("<span class='subtotal' id='subtotal_"+e.Id+"'><font size='1'></font>  <font>["+e.TotalStr+"]</font></span>");$(t).children("a").after(_),$(t).children("a").after(g),f=$("input[id='ckbx_"+e.Id+"']").length?13:0,p=$(t).children("img").is(":visible")?16:0;var m=$(t).children("a").children(".formula"),v=$(t).children("a").children(".name");if($(t).width($("#container").width()-($(t).offset().left-$("#container").offset().left)),a=$(t).width(),o=$(t).children("a").width(),idWidth=0,0,c=$(t).children(".subtotal").width(),s=$(t).children("ins").width(),"none"==m.css("display")?(m.show(),h=m.width(),m.hide()):h=m.width(),u=v.width(),0==m.children("i").length&&(h=0),o+c+s+idWidth+0+f+p+25>a){var w=o+c+s+idWidth+0+f+p+25-a;h>=w+25?m.width(h-w-25):(m.width(0),v.width(u-(w-h)))}else m.width(h+5),v.width(u+5);var y=getScrollbarWidth(document.getElementById("container"));$(t).children(".filler").css("width",a-o-c-s-idWidth-0-f-p-25-y),a-o-c-s-idWidth-0-f-p-25-y>0&&$(t).children(".filler").css("margin-right",c+y);var b=$("li[id='li_1']").position().left;$("<font width='100%' size='1' class='id' id = 'id_"+e.Id+"'>&nbsp"+e.Id+"</font>").insertBefore("li[id='li_"+e.Id+"']>ins"),$(".id").css({position:"absolute",left:b});var x=$("font[id='id_"+e.Id+"']").width(),k=$(t).children("ins").position().left;x>k?$(t).css("margin-left",x-k+13.5):$(t).css("margin-left",13.5),$("input[id='Subtotals']").is(":checked")||$(".subtotal, .filler").hide(),r="Decision"!=e.TypeStr&&"SumSet"!=e.TypeStr&&"ConditionalRules"!=e.TypeStr&&"Date"!=e.TypeStr&&"Today"!=e.TypeStr&&"Text"!=e.TypeStr||"ConditionalRules"==e.TypeStr||"Text"==e.TypeStr?"&nbsp;[<i>"+e.Expression+"</i>]":" &nbsp;&nbsp;&nbsp;",window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&"rgb(255, 0, 0)"!=$(t).children("a").css("color")&&"rgb(0, 128, 0)"!=$(t).children("a").css("color")&&$(t).children("a").attr("style","color:gray;"),window.matchMedia&&window.matchMedia("(prefers-color-scheme: light)").matches&&"rgb(255, 0, 0)"!=$(t).children("a").css("color")&&"rgb(0, 128, 0)"!=$(t).children("a").css("color")&&$(t).children("a").attr("style","color:black;"),e.Leaf&&$(t).children("a").attr("style","color:red;"),e.Hidden&&$(t).children("a").attr("style","color:green"),d="<input type='hidden' id='nodetype_"+e.Id+"' value='"+e.TypeStr+"'/> ",$(t).append(d),d="<input type='hidden' id='ishidden_"+e.Id+"' value='"+e.Hidden+"'/> ",$(t).append(d),d="<input type='hidden' id='isoptional_"+e.Id+"' value='"+e.Optional+"'/> ",$(t).append(d),d="<input type='hidden' id='dependents_"+e.Id+"' value='"+e.DependentsStr+"'/> ",$(t).append(d),d="<input type='hidden' id='editchildren_"+e.Id+"' value='"+e.EditChildren+"'/> ",$(t).append(d),d="<input type='hidden' id='expandedlevels_"+e.Id+"' value='"+e.ExpandedLevels+"'/> ",$(t).append(d),0==$(t).children("ul").length&&$(t).append("<ul id='li_ul_"+e.Id+"' style='display:inline'></ul>")}if($("#container").jstree("deselect_node",$("li[id='li_"+i+"']")),null!=e._Children)for(var T=0;T<e._Children.length;T++)null!=e._Children[T].Id&&RenderTree(e._Children[T]);$("#container").jstree("deselect_node",$("li[id='li_"+i+"']"))}function PruneTree(e,i){var t=e.Id.split(".").length-1;if("1"==e.Id||t!=i.ExpandedLevels)for(var n=0;n<e._Children.length;n++)PruneTree(e._Children[n],i);else e._Children=null}function lzw_decode(e){for(var i,t={},n=(e+"").split(""),d=n[0],l=d,r=[d],a=256,o=1;o<n.length;o++){var c=n[o].charCodeAt(0);i=c<256?n[o]:t[c]?t[c]:l+d,r.push(i),d=i.charAt(0),t[a]=l+d,a++,l=i}return r.join("")}$((function(){descriptionhidden=!1,ajaxDone=!1,asynchronous=!0,mobile=!1,treeIsLoaded=!1,expandingLevels=!1,dialogHeight=98*window.innerHeight/100,$("#container").jstree({plugins:["themes","html_data","ui","crrm","hotkeys"],themes:{theme:"default",dots:!1,icons:!1}}).bind("loaded.jstree",(function(e,i){ExpLevels=0,$.ajax({url:"getJson",type:"GET",dataType:"json",cache:!1,beforeSend:function(){},complete:function(){},success:function(e){var i=JSON.parse(e);PruneTree(i,i),RenderTree(i),RefreshFillers(1,!1),treeIsLoaded=!0,descriptionOffsetTop=$("#description").offset().top,$("#Iframe15").height($(window).height()-descriptionOffsetTop-70),$("#container").height($(window).height()-descriptionOffsetTop-40)}})})),$("#container").bind("open_node.jstree",(function(e,i){var t=i.rslt.obj.find("ul"),n=i.rslt.obj.attr("id");0==t.length||0==$(t).children("li").length?asynchronous?$.ajax({url:"ChildNodes?id="+n,type:"GET",dataType:"json",cache:!1,beforeSend:function(){},complete:function(e){},success:function(e){Assemble(e,n)}}):$.ajax({url:"ChildNodes?id="+n,type:"GET",dataType:"json",async:!1,cache:!1,beforeSend:function(){},complete:function(e){},success:function(e){Assemble(e,n)}}):treeIsLoaded&&!expandingLevels&&RefreshFillers(n.replace(/li_/g,""),!0)})),$("#container").bind("select_node.jstree",(function(e,i){i.args[0].href&&(document.getElementById("Iframe15").src=i.args[0].href)})),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(mobile=!0),$(window).on("resize",(function(){var i=dialog.dialog("isOpen");if(dialogHeight=98*window.innerHeight/100,dialog.dialog("close"),dialog=$("<div></div>").append(e).appendTo("body").dialog({autoOpen:!1,modal:!0,resizable:!1,width:"auto",height:"auto",maxHeight:dialogHeight,title:"Description",close:function(){e.attr("src","about:blank")}}).css({overflow:"auto"}),$(window).width()<"1024"&&$("input[id='Description']").is(":checked")&&(descriptionOffsetTop=$("#description").offset().top,$("input[id='Description']").click()),$(window).width()>="1024"&&!$("input[id='Description']").is(":checked")?($("input[id='Description']").click(),descriptionOffsetTop=$("#description").offset().top):$("input[id='Description']").is(":checked")&&(descriptionOffsetTop=$("#description").offset().top),$("#description").is(":hidden")&&i){var t=document.getElementById("Iframe15").contentWindow.location.href,n=mobile?"100%":40*$("#hr").width()/100,d=n;e.attr({width:+n,height:+d,src:t}),dialog.dialog("open")}Refill(),containerOffsetTop=$("#container").offset().top,$("#Iframe15").height($(window).height()-descriptionOffsetTop-70),$("#container").height($(window).height()-containerOffsetTop)}));var e=$('<iframe style="border:0;" frameborder="0" marginwidth="0" marginheight="0" allowfullscreen></iframe>');dialog=$("<div></div>").append(e).appendTo("body").dialog({autoOpen:!1,modal:!0,resizable:!1,width:"auto",height:"auto",maxHeight:dialogHeight,title:"Description",close:function(){e.attr("src","about:blank")}}).css({overflow:"auto"}),$("#Iframe15").on("load",(function(i){if(descriptionhidden){i.preventDefault();var t=document.getElementById("Iframe15").contentWindow.location.href,n=mobile?"100%":40*$("#hr").width()/100,d=n;e.attr({width:+n,height:+d,src:t}),dialog.dialog("open")}})),$(window).width()<"1024"&&$("input[id='Description']").click()}));